<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alur Pengajuan IDN Mengajar & AI Assistant</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter & Baloo 2 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Baloo+2:wght@700&display=swap" rel="stylesheet">
    <!-- Import Markdown Parser for AI Response -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Import Canvas Confetti for Surprise Effect -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617;
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(to bottom right, #061f4a, #111827, #000000);
            background-size: 40px 40px, 40px 40px, 100% 100%;
        }
        .font-display {
            font-family: 'Baloo 2', cursive;
        }
        /* Glassmorphism effect */
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .glass-card:hover {
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        /* Button hover effects */
        .action-btn {
            transition: all 0.2s ease-in-out;
        }
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        /* Tooltip Styling */
        .tooltip-container {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        .tooltip-text {
            visibility: hidden;
            width: 220px;
            background-color: #1f2937;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 8px;
            position: absolute;
            z-index: 9999; /* Increased Z-Index specifically for tooltip text */
            bottom: 140%; /* Lifted slightly higher */
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.2s;
            font-size: 0.75rem;
            font-weight: normal;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.3); /* Stronger shadow */
            border: 1px solid #374151;
            pointer-events: none;
        }
        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #1f2937 transparent transparent transparent;
        }
        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* AI Response Styling */
        .ai-content h3 { font-weight: bold; font-size: 1.1em; margin-top: 10px; margin-bottom: 5px; color: #60a5fa; }
        .ai-content ul { list-style-type: disc; margin-left: 20px; margin-bottom: 10px; }
        .ai-content ol { list-style-type: decimal; margin-left: 20px; margin-bottom: 10px; }
        .ai-content p { margin-bottom: 8px; }
        .ai-content strong { color: #fcd34d; }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1f2937; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #6b7280; }

        /* Checkbox Styling */
        .custom-checkbox {
            appearance: none;
            background-color: rgba(255, 255, 255, 0.1);
            margin: 0;
            font: inherit;
            color: currentColor;
            width: 1.2em;
            height: 1.2em;
            border: 1px solid currentColor;
            border-radius: 0.15em;
            display: grid;
            place-content: center;
            cursor: pointer;
            margin-right: 0.5em;
            margin-top: 0.2em;
            flex-shrink: 0;
            transition: all 0.2s ease;
        }
        .custom-checkbox::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em white;
            background-color: white;
            transform-origin: center;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        .custom-checkbox:checked::before {
            transform: scale(1);
            background-color: #4ade80; /* Green */
            box-shadow: inset 1em 1em #4ade80;
        }
        .custom-checkbox:checked {
            border-color: #4ade80;
            background-color: rgba(74, 222, 128, 0.1);
        }
        .strikethrough:checked + span {
            text-decoration: line-through;
            color: #6b7280;
            transition: color 0.2s;
        }
        
        /* FAQ Accordion */
        details > summary {
            list-style: none;
            cursor: pointer;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }

        /* Celebration Modal */
        #celebration-modal {
            backdrop-filter: blur(8px);
        }
        .modal-content {
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="text-gray-200">

    <!-- Loading Screen -->
    <div id="loading-screen" class="fixed inset-0 bg-gray-900 flex flex-col items-center justify-center z-50 transition-opacity duration-1000">
        <img src="https://idn.sch.id/wp-content/uploads/2024/08/cropped-Logo-IDN-Biru-2-1.png" alt="Logo IDN Placeholder" class="h-24 mb-6 animate-pulse rounded-lg">
        <div class="w-64 bg-gray-700 rounded-full h-2.5">
            <div id="loading-bar" class="bg-blue-500 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
        </div>
        <p id="loading-percentage" class="text-white text-2xl font-display mt-4">0%</p>
    </div>

    <!-- Celebration Modal -->
    <div id="celebration-modal" class="fixed inset-0 bg-black/60 z-[60] flex items-center justify-center hidden">
        <div class="modal-content bg-gray-900 border border-yellow-500/50 rounded-2xl p-8 max-w-md text-center shadow-2xl relative overflow-hidden">
            <!-- Background glow -->
            <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-yellow-500/10 to-transparent pointer-events-none"></div>
            
            <div class="relative z-10">
                <div class="w-20 h-20 bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-4xl">ðŸŽ‰</span>
                </div>
                <h2 class="text-3xl font-bold text-white mb-2 font-display">Alhamdulillah!</h2>
                <p class="text-gray-300 mb-6">Semua tahapan telah selesai. Selamat mengajar dan semoga ilmunya bermanfaat!</p>
                <button onclick="closeCelebration()" class="bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-3 px-8 rounded-full transition transform hover:scale-105">
                    Siap Laksanakan!
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content Wrapper -->
    <div class="relative z-10">
        <div class="container mx-auto px-4 py-16">

            <!-- Header Section -->
            <header class="text-center mb-12">
                <img src="https://idn.sch.id/wp-content/uploads/2024/08/cropped-Logo-IDN-Biru-2-1.png" alt="Logo IDN Placeholder" class="mx-auto h-20 md:h-24 mb-6 rounded-lg" onerror="this.style.display='none'">
                <h1 class="text-4xl md:text-5xl font-display text-white">Alur Pengajuan IDN Mengajar</h1>
                <p class="mt-3 text-lg text-gray-300 max-w-3xl mx-auto">Panduan lengkap langkah demi langkah, asisten materi, dan FAQ.</p>
            </header>

            <!-- Info Cards Container -->
            <div class="max-w-5xl mx-auto grid md:grid-cols-12 gap-6 mb-8">
                <!-- PIC & Batasan Card (Span 7 cols) -->
                <!-- ADDED Z-INDEX 20 HERE TO FIX TOOLTIP OVERLAP -->
                <div class="glass-card rounded-xl shadow-lg p-6 text-left flex flex-col justify-between md:col-span-7 relative z-20">
                    <div>
                        <h3 class="text-xl font-bold text-white mb-3 border-b border-gray-700 pb-2">PIC, Kontak & Batasan</h3>
                        <div class="flex flex-col sm:flex-row justify-between space-y-3 sm:space-y-0">
                            <div>
                                <p class="text-sm text-gray-400">Penanggung Jawab (PIC)</p>
                                <p class="font-semibold text-lg text-blue-300">Muhammad Rival</p>
                                <p class="text-sm text-gray-300">WA: 0899-8419-000</p>
                            </div>
                            <div class="sm:text-right">
                                <p class="text-sm text-gray-400">Jam Pelayanan Pengajuan</p>
                                <p class="font-semibold text-lg text-yellow-400">09.00 - 14.00 WIB</p>
                                <p class="text-sm text-gray-300">Senin - Jumat</p>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 pt-3 border-t border-gray-700 flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-400">Kuota Program</p>
                            <p class="text-red-400 font-bold text-xl">MAKSIMAL 2x / Semester</p>
                        </div>
                        <div class="tooltip-container ml-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 hover:text-white transition" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span class="tooltip-text">Jika lebih dari 2x, wajib melampirkan surat izin khusus dari Kepala Sekolah atau Waka Kurikulum.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Document Center Card (Span 5 cols) -->
                <!-- ADDED Z-INDEX 10 HERE TO STAY BELOW PIC CARD TOOLTIPS -->
                <div class="glass-card rounded-xl shadow-lg p-6 md:col-span-5 flex flex-col relative z-10">
                    <h3 class="text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2">Pusat Dokumen</h3>
                    <div class="flex flex-col space-y-3 h-full justify-center">
                        <a href="/idn-mengajar/proposal.html" class="action-btn bg-gray-800 hover:bg-gray-700 border border-gray-600 text-white p-3 rounded-lg flex items-center justify-between group">
                            <div class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-400 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                <span>Proposal</span>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 group-hover:text-white transition" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
                        </a>
                        
                        <a href="https://forms.gle/j5uKrVvML3X1jijNA" class="action-btn bg-gray-800 hover:bg-gray-700 border border-gray-600 text-white p-3 rounded-lg flex items-center justify-between group">
                            <div class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-400 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                                <span>Link Form Record (Wajib)</span>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 group-hover:text-white transition" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Gemini AI Assistant Section -->
            <div class="max-w-5xl mx-auto mb-16">
                <div class="glass-card rounded-xl shadow-lg p-6 border border-blue-500/30">
                    <div class="flex items-center justify-between mb-4 border-b border-gray-700 pb-3">
                        <div class="flex items-center">
                            <div class="p-2 bg-blue-600 rounded-lg mr-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold text-white bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">
                                    Asisten Cerdas IDN Mengajar âœ¨
                                </h3>
                                <p class="text-xs text-gray-400">Buat rencana materi & ice breaking instan dengan AI</p>
                            </div>
                        </div>
                        <span class="text-xs bg-gray-800 px-2 py-1 rounded text-gray-400 border border-gray-700">Powered by Gemini</span>
                    </div>
                    
                    <div class="grid md:grid-cols-12 gap-6">
                        <!-- Inputs (Span 5) -->
                        <div class="space-y-4 md:col-span-5">
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-1">Topik IT / Materi</label>
                                <input type="text" id="ai-topic" placeholder="Contoh: Coding Dasar, IoT, Canva" class="w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition placeholder-gray-600">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-1">Target Siswa</label>
                                <select id="ai-audience" class="w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 outline-none transition">
                                    <option value="Siswa SD">Siswa SD</option>
                                    <option value="Siswa SMP">Siswa SMP</option>
                                    <option value="Siswa SMA/SMK">Siswa SMA/SMK</option>
                                </select>
                            </div>

                            <!-- Input Durasi -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-400 mb-1">Durasi (Hari)</label>
                                    <input type="number" id="ai-days" placeholder="1" min="1" class="w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 outline-none transition placeholder-gray-600">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-400 mb-1">Jam per Hari</label>
                                    <input type="number" id="ai-hours" placeholder="2" min="1" class="w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 outline-none transition placeholder-gray-600">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-3 pt-2">
                                <button onclick="generateIdea('lesson')" id="btn-lesson" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-2 rounded-lg transition duration-200 flex items-center justify-center text-sm shadow-lg shadow-indigo-900/20">
                                    Buat Materi ðŸ“š
                                </button>
                                <button onclick="generateIdea('icebreaker')" id="btn-ice" class="bg-pink-600 hover:bg-pink-700 text-white font-semibold py-3 px-2 rounded-lg transition duration-200 flex items-center justify-center text-sm shadow-lg shadow-pink-900/20">
                                    Ice Breaking ðŸ§Š
                                </button>
                            </div>
                            <p id="error-msg" class="text-red-400 text-xs hidden mt-2"></p>
                        </div>

                        <!-- Output (Span 7) -->
                        <div class="md:col-span-7 bg-gray-900/50 rounded-lg border border-gray-700 p-4 h-[340px] flex flex-col relative">
                            <div id="ai-content-container" class="overflow-y-auto custom-scrollbar flex-grow relative">
                                <div id="ai-placeholder" class="flex flex-col items-center justify-center h-full text-gray-500 text-center pt-16">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-3 opacity-30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                    </svg>
                                    <p class="text-sm">Isi detail di sebelah kiri, lalu klik tombol untuk mendapatkan ide dari AI.</p>
                                </div>
                                
                                <!-- Loading State -->
                                <div id="ai-loading" class="hidden space-y-3 p-2">
                                    <div class="h-4 bg-gray-700 rounded w-3/4 shimmer"></div>
                                    <div class="h-4 bg-gray-700 rounded w-full shimmer"></div>
                                    <div class="h-4 bg-gray-700 rounded w-5/6 shimmer"></div>
                                    <div class="h-4 bg-gray-700 rounded w-1/2 shimmer"></div>
                                    <div class="h-4 bg-gray-700 rounded w-3/4 shimmer mt-4"></div>
                                </div>

                                <!-- Result Container -->
                                <div id="ai-result" class="hidden ai-content text-sm text-gray-200 leading-relaxed pb-10"></div>
                            </div>

                            <!-- Copy Button (Floating Bottom Right inside container) -->
                            <button id="btn-copy" onclick="copyAIResult()" class="hidden absolute bottom-4 right-4 bg-gray-700 hover:bg-gray-600 text-white text-xs py-2 px-3 rounded-lg shadow-lg border border-gray-600 transition flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                </svg>
                                Salin Teks
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Timeline Container -->
            <div class="max-w-5xl mx-auto mb-20">
                <h3 class="text-2xl font-bold text-white mb-2 text-center">Langkah-Langkah Pengajuan</h3>
                <p class="text-gray-400 text-center mb-8 text-sm bg-blue-900/20 inline-block px-4 py-1 rounded-full mx-auto border border-blue-800/50">
                    ðŸ’¡ <strong>Tips:</strong> Centang kotak di bawah ini untuk menyimpan progresmu. Otomatis tersimpan di browser!
                </p>
                
                <div class="relative">
                    <!-- Vertical line -->
                    <div class="absolute left-10 top-0 h-full w-0.5 bg-blue-900/50"></div>

                    <!-- TAHAP 1 -->
                    <div class="relative flex items-start mb-12 group">
                        <div class="flex-shrink-0 w-20 h-20 bg-gray-900 border-4 border-blue-500 text-blue-400 rounded-full flex items-center justify-center z-10 shadow-lg shadow-blue-900/30">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-9 w-9" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.125-1.273-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.125-1.273.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                        </div>
                        <div class="ml-8 w-full">
                            <div class="glass-card p-6 rounded-xl shadow-lg hover:shadow-blue-500/20 hover:-translate-y-1 transition-all duration-300">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs font-bold tracking-wider text-blue-400 bg-blue-900/30 px-2 py-1 rounded">TAHAP 1</span>
                                </div>
                                <h3 class="text-2xl font-bold text-white">Pembentukan Tim & Izin Ortu</h3>
                                <div class="mt-4 flex flex-col space-y-3 text-gray-300">
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Bentuk tim (maks. 4 siswa) dan daftar ke PIC untuk <strong class="text-yellow-400 tooltip-container border-b border-dotted border-yellow-400 cursor-help">Persetujuan Awal<span class="tooltip-text">Pastikan anggota tim memenuhi syarat dan kuota tim belum penuh.</span></strong>.
                                        </span>
                                    </label>
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Kumpulkan & serahkan <strong class="text-yellow-400 tooltip-container border-b border-dotted border-yellow-400 cursor-help">Bukti Izin Ortu<span class="tooltip-text">Screenshot Chat WA persetujuan ortu atau foto surat izin.</span></strong> ke PIC.
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAHAP 2 -->
                    <div class="relative flex items-start mb-12 group">
                        <div class="flex-shrink-0 w-20 h-20 bg-gray-900 border-4 border-indigo-500 text-indigo-400 rounded-full flex items-center justify-center z-10 shadow-lg shadow-indigo-900/30">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-9 w-9" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/></svg>
                        </div>
                        <div class="ml-8 w-full">
                            <div class="glass-card p-6 rounded-xl shadow-lg hover:shadow-indigo-500/20 hover:-translate-y-1 transition-all duration-300">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs font-bold tracking-wider text-indigo-400 bg-indigo-900/30 px-2 py-1 rounded">TAHAP 2</span>
                                </div>
                                <h3 class="text-2xl font-bold text-white">Perencanaan & Proposal</h3>
                                <div class="mt-4 flex flex-col space-y-3 text-gray-300">
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Buat Rencana Awal (Sekolah, Materi, Waktu).
                                        </span>
                                    </label>
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Minta & isi Google Form <strong class="text-yellow-400">"Pengajuan IDN Mengajar"</strong>.
                                        </span>
                                    </label>
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Buat <strong class="text-yellow-400">Proposal Tim (Draft)</strong> menggunakan template.
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAHAP 3 -->
                    <div class="relative flex items-start mb-12 group">
                        <div class="flex-shrink-0 w-20 h-20 bg-gray-900 border-4 border-purple-500 text-purple-400 rounded-full flex items-center justify-center z-10 shadow-lg shadow-purple-900/30">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-9 w-9" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.693a9 9 0 01-1.34-4.307c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
                        </div>
                        <div class="ml-8 w-full">
                            <div class="glass-card p-6 rounded-xl shadow-lg hover:shadow-purple-500/20 hover:-translate-y-1 transition-all duration-300">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs font-bold tracking-wider text-purple-400 bg-purple-900/30 px-2 py-1 rounded">TAHAP 3</span>
                                </div>
                                <h3 class="text-2xl font-bold text-white">Surat & Negosiasi</h3>
                                <div class="mt-4 flex flex-col space-y-3 text-gray-300">
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Kirim <strong class="text-blue-300">Surat Permohonan</strong> (dari PIC) ke Sekolah Klien.
                                        </span>
                                    </label>
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            <span class="text-red-400 font-bold">WAJIB:</span> Minta <strong class="text-red-400">Surat Balasan</strong> dari sekolah & serahkan ke PIC.
                                        </span>
                                    </label>
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Buat & ajukan <strong class="text-white">Rundown Rinci</strong> untuk Persetujuan Final.
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAHAP 4 -->
                    <div class="relative flex items-start group">
                        <div class="flex-shrink-0 w-20 h-20 bg-gray-900 border-4 border-rose-500 text-rose-400 rounded-full flex items-center justify-center z-10 shadow-lg shadow-rose-900/30">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-9 w-9" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg>
                        </div>
                        <div class="ml-8 w-full">
                            <div class="glass-card p-6 rounded-xl shadow-lg hover:shadow-rose-500/20 hover:-translate-y-1 transition-all duration-300">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs font-bold tracking-wider text-rose-400 bg-rose-900/30 px-2 py-1 rounded">TAHAP 4</span>
                                </div>
                                <h3 class="text-2xl font-bold text-white">Berangkat & Pelaporan</h3>
                                <div class="mt-4 flex flex-col space-y-3 text-gray-300">
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Terima Surat Tugas & Isi Form <strong class="text-red-400">Record IDN Mengajar</strong> (Sebelum Berangkat).
                                        </span>
                                    </label>
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            Cetak dokumen & minta izin Wakasis.
                                        </span>
                                    </label>
                                    <label class="flex items-start group cursor-pointer">
                                        <input type="checkbox" class="custom-checkbox strikethrough">
                                        <span class="transition-colors group-hover:text-white">
                                            <span class="text-red-400 font-bold">PASCA:</span> Upload dokumentasi ke Google Foto.
                                        </span>
                                    </label>
                                    <div class="pt-2">
                                        <p class="text-xs text-red-400 italic bg-red-900/20 p-2 rounded border border-red-900/50">
                                            SANKSI: Gagal mengisi form / upload dokumentasi = BAN OTOMATIS.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- FAQ Section -->
            <div class="max-w-5xl mx-auto mb-16">
                <h3 class="text-2xl font-bold text-white mb-6 text-center">Pertanyaan Sering Diajukan (FAQ)</h3>
                <div class="space-y-4">
                    <div class="glass-card rounded-lg overflow-hidden">
                        <details class="group">
                            <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-4 text-white bg-gray-800/50 hover:bg-gray-800 transition">
                                <span>Sekolah menolak proposal kami, apa yang harus dilakukan?</span>
                                <span class="transition group-open:rotate-180">
                                    <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"><path d="M6 9l6 6 6-6"></path></svg>
                                </span>
                            </summary>
                            <div class="text-gray-300 p-4 bg-black/20 text-sm leading-relaxed">
                                Jangan panik. Laporkan penolakan tersebut ke PIC. Kalian memiliki dua opsi: mencoba melobi ulang dengan materi/waktu berbeda, atau mencari sekolah target yang baru. Ingat, penolakan adalah hal biasa dalam proses ini.
                            </div>
                        </details>
                    </div>
                    <div class="glass-card rounded-lg overflow-hidden">
                        <details class="group">
                            <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-4 text-white bg-gray-800/50 hover:bg-gray-800 transition">
                                <span>Apakah anggota tim boleh berbeda angkatan/jurusan?</span>
                                <span class="transition group-open:rotate-180">
                                    <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"><path d="M6 9l6 6 6-6"></path></svg>
                                </span>
                            </summary>
                            <div class="text-gray-300 p-4 bg-black/20 text-sm leading-relaxed">
                                Secara umum diperbolehkan, asalkan jadwal keberangkatan tidak mengganggu kegiatan akademik krusial masing-masing angkatan (misal: ujian blok). Konsultasikan nama-nama anggota tim ke PIC untuk persetujuan.
                            </div>
                        </details>
                    </div>
                    <div class="glass-card rounded-lg overflow-hidden">
                        <details class="group">
                            <summary class="flex justify-between items-center font-medium cursor-pointer list-none p-4 text-white bg-gray-800/50 hover:bg-gray-800 transition">
                                <span>Apa yang terjadi jika saya lupa mengisi Form Record sebelum berangkat?</span>
                                <span class="transition group-open:rotate-180">
                                    <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"><path d="M6 9l6 6 6-6"></path></svg>
                                </span>
                            </summary>
                            <div class="text-gray-300 p-4 bg-black/20 text-sm leading-relaxed">
                                Secara teknis Anda dianggap tidak mengikuti kegiatan (absen). Ini berisiko sanksi akademik dan pemblokiran (Ban) dari program IDN Mengajar berikutnya. Segera hubungi PIC jika terlanjur lupa, tapi jangan jadikan kebiasaan.
                            </div>
                        </details>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="text-center mt-20 text-gray-500 text-sm pb-8 border-t border-gray-800 pt-8">
                <p>&copy; 2024 Program IDN Mengajar. Dibuat untuk mempermudah siswa IDN.</p>
            </footer>

        </div>
    </div>

    <script>
        // Loading Screen Logic
        const loadingScreen = document.getElementById('loading-screen');
        const loadingBar = document.getElementById('loading-bar');
        const loadingPercentage = document.getElementById('loading-percentage');
        
        let progress = 0;
        const interval = setInterval(() => {
            progress += 1;
            loadingBar.style.width = progress + '%';
            loadingPercentage.textContent = progress + '%';

            if (progress >= 100) {
                clearInterval(interval);
                setTimeout(() => {
                    loadingScreen.classList.add('opacity-0', 'pointer-events-none');
                }, 500); 
            }
        }, 30);

        // --- CHECKLIST PERSISTENCE & SURPRISE LOGIC ---
        const checkboxes = document.querySelectorAll('.custom-checkbox');
        const STORAGE_KEY = 'idnMengajarChecklist';
        const celebrationModal = document.getElementById('celebration-modal');

        // Load saved state
        function loadProgress() {
            const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
            if (saved && Array.isArray(saved)) {
                checkboxes.forEach((cb, index) => {
                    cb.checked = saved[index] || false;
                });
            }
        }

        // Save state & check for completion
        function saveProgress() {
            const state = Array.from(checkboxes).map(cb => cb.checked);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
            
            // Check if all are checked
            const allChecked = state.every(Boolean);
            if (allChecked && state.length > 0) {
                triggerSurprise();
            }
        }

        // Surprise Effect
        function triggerSurprise() {
            // 1. Launch Confetti
            var duration = 3 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 100 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);

            // 2. Show Modal after short delay
            setTimeout(() => {
                celebrationModal.classList.remove('hidden');
            }, 800);
        }

        function closeCelebration() {
            celebrationModal.classList.add('hidden');
            // Reset checkboxes
            checkboxes.forEach(cb => cb.checked = false);
            localStorage.removeItem(STORAGE_KEY);
        }

        // Add listeners
        checkboxes.forEach(cb => {
            cb.addEventListener('change', saveProgress);
        });

        // Init Load
        loadProgress();


        // --- GEMINI AI INTEGRATION ---
        
        async function generateIdea(type) {
            const topicInput = document.getElementById('ai-topic').value;
            const audienceInput = document.getElementById('ai-audience').value;
            const daysInput = document.getElementById('ai-days').value;
            const hoursInput = document.getElementById('ai-hours').value;
            const resultDiv = document.getElementById('ai-result');
            const loadingDiv = document.getElementById('ai-loading');
            const placeholderDiv = document.getElementById('ai-placeholder');
            const errorMsg = document.getElementById('error-msg');
            const copyBtn = document.getElementById('btn-copy');

            // Basic Validation
            if (!topicInput.trim()) {
                errorMsg.textContent = "Harap isi topik terlebih dahulu!";
                errorMsg.classList.remove('hidden');
                return;
            }
            // Validate duration for lesson type
            if (type === 'lesson' && (!daysInput || !hoursInput)) {
                errorMsg.textContent = "Harap isi durasi hari dan jam!";
                errorMsg.classList.remove('hidden');
                return;
            }

            errorMsg.classList.add('hidden');
            copyBtn.classList.add('hidden');

            // UI State: Loading
            placeholderDiv.classList.add('hidden');
            resultDiv.classList.add('hidden');
            loadingDiv.classList.remove('hidden');

            // Construct Prompt
            let prompt = "";
            if (type === 'lesson') {
                prompt = `Buatkan kerangka materi ajar IT/Teknologi yang **sangat ringkas, padat, dan langsung pada intinya** tentang topik "${topicInput}" untuk ${audienceInput}. Durasi total: ${daysInput} hari, ${hoursInput} jam/hari. 
                Berikan outline materi per hari (Hari 1, Hari 2, dst) sesuai durasi.
                Hanya sertakan poin-poin penting dan 1 aktivitas praktek utama. Jangan bertele-tele atau memberikan intro yang terlalu panjang. Format Markdown.`;
            } else {
                prompt = `Berikan 3 ide ice breaking singkat, padat, dan seru untuk ${audienceInput} sebelum materi IT "${topicInput}". Langsung jelaskan cara mainnya tanpa basa-basi. Format Markdown.`;
            }

            try {
                const apiKey = "YOUR_GEMINI_API_KEY_PLACEHOLDER"; // System handles API Key
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: prompt }]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error('Gagal menghubungi AI');
                }

                const data = await response.json();
                const aiText = data.candidates[0].content.parts[0].text;

                // Render Markdown
                resultDiv.innerHTML = marked.parse(aiText);
                
                // UI State: Success
                loadingDiv.classList.add('hidden');
                resultDiv.classList.remove('hidden');
                copyBtn.classList.remove('hidden');

            } catch (error) {
                console.error(error);
                loadingDiv.classList.add('hidden');
                resultDiv.innerHTML = `<p class="text-red-400">Maaf, terjadi kesalahan saat menghubungi asisten AI. Coba lagi nanti ya!</p>`;
                resultDiv.classList.remove('hidden');
            }
        }

        function copyAIResult() {
            const resultDiv = document.getElementById('ai-result');
            const textToCopy = resultDiv.innerText;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                const btn = document.getElementById('btn-copy');
                const originalText = btn.innerHTML;
                
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg> Tersalin!`;
                btn.classList.remove('bg-gray-700', 'hover:bg-gray-600');
                btn.classList.add('bg-green-600', 'hover:bg-green-500');
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.add('bg-gray-700', 'hover:bg-gray-600');
                    btn.classList.remove('bg-green-600', 'hover:bg-green-500');
                }, 2000);
            }).catch(err => {
                console.error('Gagal menyalin:', err);
            });
        }
    </script>

</body>
</html>